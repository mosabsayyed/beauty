function resolveDataKey(key: string | undefined, dataPoint: any): string | undefined {
  if (!key || !dataPoint) return undefined;

  // 1. Exact match
  if (Object.prototype.hasOwnProperty.call(dataPoint, key)) return key;

  // 2. Case-insensitive match
  const lowerKey = key.toLowerCase();
  const foundKey = Object.keys(dataPoint).find(k => k.toLowerCase() === lowerKey);
  if (foundKey) return foundKey;

  // 3. Partial match (if key is "Number of Projects", find "count" or "projects")
  // This is a heuristic. If the label contains the key, or vice versa.
  // For "Number of Projects" -> "count" (no match).
  // But usually "Quarter" -> "quarter" is handled by step 2.
  
  // 4. Fallback for specific known patterns (based on user samples)
  if (lowerKey.includes('number') || lowerKey.includes('count')) {
     const countKey = Object.keys(dataPoint).find(k => k.toLowerCase().includes('count') || k.toLowerCase().includes('total'));
     if (countKey) return countKey;
  }
  
  return undefined;
}
